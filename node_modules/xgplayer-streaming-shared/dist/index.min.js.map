{"version":3,"file":"index.min.js","sources":["../src/utils.js","../src/buffer.js","../src/error.js","../src/env.js","../src/logger.js","../src/mse.js","../src/net/types.js","../src/net/error.js","../src/is.js","../src/net/helper.js","../src/event.js","../../../node_modules/eventemitter3/index.js","../src/net/fetch.js","../src/net/xhr.js","../src/net/task.js","../src/streaming-helper.js","../src/net/index.js","../src/net/config.js","../src/services/gap.js","../src/services/sei.js","../src/services/bandwidth.js","../src/services/stats.js","../src/index.umd.js"],"sourcesContent":["export function createPublicPromise () {\n  let res, rej\n  const promise = new Promise((resolve, reject) => {\n    res = resolve\n    rej = reject\n  })\n  promise.used = false\n  promise.resolve = (...args) => {\n    promise.used = true\n    return res(...args)\n  }\n  promise.reject = (...args) => {\n    promise.used = true\n    return rej(...args)\n  }\n  return promise\n}\n\nexport function nowTime () {\n  try {\n    return parseInt(performance.now(), 10)\n  } catch (e) {\n    return new Date().getTime()\n  }\n}\n","export class Buffer {\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static start (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n    // Edge bug: https://bit.ly/2JYLPeB\n    if (buf.length === 1 && buf.start(0) < 0) return 0\n\n    return buf.start(0)\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static end (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n\n    return buf.end(buf.length - 1)\n  }\n\n  /**\n   * @param {{buffered?: TimeRanges}} b\n   * @returns {TimeRanges | void}\n   */\n  static get (b) {\n    if (!b) return\n    try {\n      return b.buffered\n    } catch (error) {\n      // ignore\n    }\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {[number,number][]}\n   */\n  static buffers (buf, maxHole) {\n    if (!buf || !buf.length) return []\n\n    const buffers = []\n    for (let i = 0, l = buf.length; i < l; i++) {\n      const bufLen = buffers.length\n      if (!bufLen || !maxHole) {\n        buffers.push([buf.start(i), buf.end(i)])\n      } else {\n        const last = buffers[bufLen - 1]\n        const lastEnd = last[1]\n        const start = buf.start(i)\n        if (start - lastEnd <= maxHole) {\n          const end = buf.end(i)\n          if (end > lastEnd) {\n            last[1] = end\n          }\n        } else {\n          buffers.push([buf.start(i), buf.end(i)])\n        }\n      }\n    }\n    return buffers\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {{buffers:[number,number][],length:number}}\n   */\n  static totalLength (buffers) {\n    if (!buffers || !buffers.length) return 0\n    return buffers.reduce((a, c) => (a += (c[1] - c[0])), 0)\n  }\n\n  /**\n   *\n   * @param {TimeRanges} buf\n   * @param {number} [pos=0]\n   * @param {number} [maxHole=0]\n   * @returns {{start:number,end:number,buffers:[number,number][],remaining:number,index?:number,nextStart?:number,nextEnd?:number,prevStart?:number,prevEnd?:number}}\n   */\n  static info (buf, pos = 0, maxHole = 0) {\n    if (!buf || !buf.length) return { start: 0, end: 0, buffers: [] }\n\n    let start = 0\n    let end = 0\n    let index = 0\n    let nextStart = 0\n    let nextEnd = 0\n    let prevStart = 0\n    let prevEnd = 0\n    const buffers = Buffer.buffers(buf, maxHole)\n\n    for (let i = 0, l = buffers.length; i < l; i++) {\n      const item = buffers[i]\n      if (pos + maxHole >= item[0] && pos <= item[1]) {\n        start = item[0]\n        end = item[1]\n        index = i\n      } else if (pos + maxHole < item[0]) {\n        nextStart = item[0]\n        nextEnd = item[1]\n        break\n      } else if (pos + maxHole > item[1]) {\n        prevStart = item[0]\n        prevEnd = item[1]\n      }\n    }\n\n    return {\n      start,\n      end,\n      index,\n      buffers,\n      nextStart,\n      nextEnd,\n      prevStart,\n      prevEnd,\n      currentTime: pos,\n      behind: pos - start,\n      remaining: end ? end - pos : 0,\n      length: Buffer.totalLength && Buffer.totalLength(buffers)\n    }\n  }\n}\n","export const ERR = {\n  MANIFEST: 'manifest',\n  NETWORK: 'network',\n  NETWORK_TIMEOUT: 'network_timeout',\n  NETWORK_FORBIDDEN:'network_forbidden',\n  NETWORK_NOTFOUND: 'network_notfound',\n  NETWROK_RANGE_NOT_SATISFIABLE:'network_range_not_satisfiable',\n  DEMUX: 'demux',\n  REMUX: 'remux',\n  MEDIA: 'media',\n  DRM: 'drm',\n  OTHER: 'other',\n  RUNTIME:'runtime',\n\n  SUB_TYPES: {\n    FLV: 'FLV',\n    HLS: 'HLS',\n    MP4: 'MP4',\n    FMP4: 'FMP4',\n    MSE_ADD_SB: 'MSE_ADD_SB',\n    MSE_APPEND_BUFFER: 'MSE_APPEND_BUFFER',\n    MSE_OTHER: 'MSE_OTHER',\n    MSE_FULL: 'MSE_FULL',\n    OPTION: 'OPTION',\n    DASH:'DASH',\n    LICENSE:'LICENSE',\n    CUSTOM_LICENSE:'CUSTOM_LICENSE',\n    MSE_HIJACK:'MSE_HIJACK',\n    EME_HIJACK:'EME_HIJACK',\n    SIDX:'SIDX',\n    NO_CANPLAY_ERROR:'NO_CANPLAY_ERROR',\n    BUFFERBREAK_ERROR:'BUFFERBREAK_ERROR',\n    WAITING_TIMEOUT_ERROR: 'WAITING_TIMEOUT_ERROR',\n    MEDIA_ERR_ABORTED:'MEDIA_ERR_ABORTED',\n    MEDIA_ERR_NETWORK:'MEDIA_ERR_NETWORK',\n    MEDIA_ERR_DECODE:'MEDIA_ERR_DECODE',\n    MEDIA_ERR_SRC_NOT_SUPPORTED:'MEDIA_ERR_SRC_NOT_SUPPORTED',\n    MEDIA_ERR_CODEC_NOT_SUPPORTED:'MEDIA_ERR_CODEC_NOT_SUPPORTED',\n    MEDIA_ERR_URL_EMPTY:'MEDIA_ERR_URL_EMPTY'\n  }\n}\n\nexport const ERR_CODE = {\n  [ERR.MANIFEST]: {\n    HLS: 1100,\n    DASH:1200\n  },\n  [ERR.NETWORK]: 2100,\n  [ERR.NETWORK_TIMEOUT]: 2101,\n  [ERR.NETWORK_FORBIDDEN]:2103,\n  [ERR.NETWORK_NOTFOUND]:2104,\n  [ERR.NETWROK_RANGE_NOT_SATISFIABLE]:2116,\n  [ERR.DEMUX]: {\n    FLV: 3100,\n    HLS: 3200,\n    MP4: 3300,\n    FMP4: 3400,\n    SIDX: 3410\n  },\n  [ERR.REMUX]: {\n    FMP4: 4100,\n    MP4: 4200\n  },\n  [ERR.MEDIA]: {\n    MEDIA_ERR_ABORTED: 5101,\n    MEDIA_ERR_NETWORK: 5102,\n    MEDIA_ERR_DECODE: 5103,\n    MEDIA_ERR_SRC_NOT_SUPPORTED: 5104,\n    MEDIA_ERR_CODEC_NOT_SUPPORTED: 5105,\n    MEDIA_ERR_URL_EMPTY: 5106,\n    MSE_ADD_SB: 5200,\n    MSE_APPEND_BUFFER: 5201,\n    MSE_OTHER: 5202,\n    MSE_FULL: 5203,\n    MSE_HIJACK:5204,\n    EME_HIJACK:5301\n  },\n  [ERR.DRM]:{\n    LICENSE:7100,\n    CUSTOM_LICENSE:7200\n  },\n  [ERR.OTHER]: 8000,\n  [ERR.RUNTIME]:{\n    NO_CANPLAY_ERROR:9001,\n    BUFFERBREAK_ERROR:9002,\n    WAITING_TIMEOUT_ERROR:9003\n  }\n}\n\n\n\nexport class StreamingError extends Error {\n  constructor (type, subType, origin, payload, msg) {\n    super(msg || origin?.message)\n    this.errorType = type === ERR.NETWORK_TIMEOUT ? ERR.NETWORK : type\n    this.originError = origin\n    this.ext = payload\n    this.errorCode = ERR_CODE[type][subType] || ERR_CODE[type]\n    this.errorMessage = this.message\n    if (!this.errorCode) {\n      this.errorType = ERR.OTHER\n      this.errorCode = ERR_CODE[this.errorType]\n    }\n  }\n\n  static create (type, subType, origin, payload, msg) {\n    if (type instanceof StreamingError) {\n      return type\n    } else if (type instanceof Error) {\n      origin = type\n      type = ''\n    }\n\n    if (!type) type = ERR.OTHER\n\n    return new StreamingError(type, subType, origin, payload, msg)\n  }\n\n  static network (error) {\n    return new StreamingError(\n      error?.isTimeout ? ERR.NETWORK_TIMEOUT : ERR.NETWORK,\n      null,\n      error instanceof Error ? error : null,\n      {\n        url: error?.url,\n        response: error?.response,\n        httpCode: error?.response?.status\n      }\n    )\n  }\n}\n","export const isBrowser = typeof window !== 'undefined'\n","\nexport const LogCacheLevel = {\n  'DEBUG': 1,\n  'LOG': 2,\n  'WARN': 3,\n  'ERROR': 4\n}\nconst LOG_MAX_SIZE = 200 * 1024\nconst SIMPLE_TYPE = ['Boolean', 'Number' ,'String', 'Undefined','Null', 'Date','Object']\nexport class Logger {\n  constructor (name,config) {\n    this.name = name || ''\n    this._prefix = `[${this.name}]`\n    this.logCacheLevel = config?.logCacheLevel || 3\n    this.logMaxSize = config?.logMaxSize || LOG_MAX_SIZE\n    this.logSize = 0\n    this.logTextArray = []\n  }\n\n  debug (...args) {\n    this.logCache(LogCacheLevel.DEBUG,...args)\n    if (Logger.disabled) return\n    console.debug(this._prefix, nowTime(), ...args)\n  }\n\n  log (...args) {\n    this.logCache(LogCacheLevel.LOG,...args)\n    if (Logger.disabled) return\n    console.log(this._prefix, nowTime(), ...args)\n  }\n\n  warn (...args) {\n    this.logCache(LogCacheLevel.WARN,...args)\n    if (Logger.disabled) return\n    console.warn(this._prefix, nowTime(), ...args)\n  }\n\n  error (...args) {\n    this.logCache(LogCacheLevel.ERROR,...args)\n    if (Logger.disabled) return\n    console.error(this._prefix, nowTime(), ...args)\n  }\n\n  logCache (logCacheLevel, ...logText) {\n    if (logCacheLevel < this.logCacheLevel) return\n    let text = ''\n    try {\n      const finLogText = logText.map( item => logable(item))\n      text = this._prefix + nowTime() + (JSON.stringify(finLogText))\n    } catch (e) {\n      return\n    }\n    if (logCacheLevel >= this.logCacheLevel) {\n      this.logSize += text.length\n      this.logTextArray.push(text)\n    }\n    if (this.logSize > this.logMaxSize) {\n      const delLog = this.logTextArray.shift()\n      this.logSize -= delLog.length\n    }\n  }\n\n  getLogCache () {\n    const logText = this.logTextArray.join('\\n')\n    this.reset()\n    return logText\n  }\n\n  reset () {\n    this.logTextArray = []\n    this.logSize = 0\n  }\n\n  table (...args) {\n    if (Logger.disabled) return\n    console.group(this._prefix)\n    console.table(...args)\n    console.groupEnd()\n  }\n\n  static disabled = true\n\n  static enable () {\n    Logger.disabled = false\n  }\n\n  static disable () {\n    Logger.disabled = true\n  }\n\n  setLogLevel (val) {\n    this.logCacheLevel = val\n  }\n}\nfunction nowTime () {\n  return new Date().toLocaleString()\n}\n\nfunction reduceDepth (val) {\n  if (typeof val !== 'object') {\n    return val\n  }\n  const objType = Object.prototype.toString.call(val).slice(8, -1)\n  switch (objType) {\n    case 'Array':\n    case 'Uint8Array':\n    case 'ArrayBuffer':\n\n      return objType + '[' + val.length + ']'\n    case 'Object':\n      return '{}'\n    default:\n      return objType\n  }\n}\n\nfunction logable (obj, maxDepth, depth) {\n  if (!depth) depth = 1\n  if (!maxDepth) maxDepth = 2\n  const result = {}\n\n  if (!obj || typeof obj !== 'object') {\n    return obj\n  }\n\n  const objType = Object.prototype.toString.call(obj).slice(8, -1)\n  if (!SIMPLE_TYPE.includes(objType)) {\n    return objType\n  }\n\n  if (depth > maxDepth) {\n    return undefined\n  }\n\n\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (depth === maxDepth) {\n        result[key] = reduceDepth(obj[key])\n      } else if (typeof obj[key] === 'object') {\n        result[key] = logable(obj[key], maxDepth, depth + 1)\n      } else {\n        result[key] = obj[key]\n      }\n    }\n  }\n  return result\n}\n\n","/* eslint-disable no-undef */\nimport { createPublicPromise, nowTime } from './utils'\nimport { Buffer } from './buffer'\nimport { StreamingError, ERR } from './error'\nimport { isBrowser } from './env'\nimport { Logger } from './logger'\n\nfunction getMediaSource (preferMMS = true) {\n  try {\n    if (!isBrowser) return null\n\n    if (preferMMS && typeof ManagedMediaSource !== 'undefined') return ManagedMediaSource\n\n    return window.MediaSource\n  } catch (e) {}\n}\n\n/** @enum {string} */\nexport const MSEErrorType = {\n  UPDATE_ERROR: 'updateError'\n}\n\nconst OP_NAME = {\n  APPEND: 'appendBuffer',\n  REMOVE: 'removeBuffer',\n  UPDATE_DURATION:'updateDuration'\n}\n\nexport class MSEError extends Error {\n  /**\n   * @param {MSEErrorType} type\n   * @param {any} [msg]\n   */\n  constructor (type, msg) {\n    super(msg || type)\n    this.type = type\n    this.msg = msg\n  }\n}\n\nexport class MSE {\n  /** @type { HTMLMediaElement | null } */\n  media = null\n\n  /** @type { MediaSource | null } */\n  mediaSource = null\n\n  _openPromise = createPublicPromise()\n\n  _queue = Object.create(null)\n\n  _sourceBuffer = Object.create(null)\n\n  static VIDEO = 'video'\n\n  static AUDIO = 'audio'\n\n  _mseFullFlag = {}\n\n  _st = 0\n\n  _opst = 0\n\n  _logger = null\n\n  _config = null\n  _url = null\n\n\n  static getDefaultConfig () {\n    return {\n      openLog: false,\n      perferMMS: false\n    }\n  }\n\n  /**\n   * @param {HTMLMediaElement} [media]\n   */\n  constructor (media, config) {\n    this._config = Object.assign(MSE.getDefaultConfig(), config)\n    if (media) this.bindMedia(media)\n    this._logger = new Logger('MSE')\n    if (this._config.openLog) {\n      Logger.enable()\n    }\n  }\n\n  get isOpened () {\n    return this.mediaSource?.readyState === 'open'\n  }\n\n  get url () {\n    return this._url\n  }\n\n  get duration () {\n    return this.mediaSource?.duration || -1\n  }\n\n  get isEnded () {\n    return this.mediaSource ? this.mediaSource.readyState === 'ended' : false\n  }\n\n  isFull (type) {\n    return type ? this._mseFullFlag[type] : this._mseFullFlag[MSE.VIDEO]\n  }\n\n  /**\n   * @param { number } duration\n   * @return { Promise }\n   */\n  updateDuration (duration) {\n    const isReduceDuration = this.mediaSource && this.mediaSource.duration > duration\n    if (this.mediaSource && this.mediaSource.duration > duration) {\n      let bufferEnd = 0\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          bufferEnd = Math.max(this.bufferEnd(k) || 0, bufferEnd)\n        } catch (error) {\n          // ignore\n        }\n      })\n      if (duration < bufferEnd) {\n        // 设置值比bufferEnd值小，会导致异常\n        return Promise.resolve()\n      }\n    }\n\n    return this._enqueueBlockingOp(() => {\n      if (this.isEnded) {\n        this._logger.debug('[debug mse] setDuration ended')\n        return\n      }\n      if (this.mediaSource) {\n        this.mediaSource.duration = duration\n        this._logger.debug('[debug mse] setDuration')\n      }\n    }, OP_NAME.UPDATE_DURATION, {isReduceDuration})\n  }\n\n  /** @return { Promise } */\n  open () {\n    if (this._openPromise.used && !this.isOpened && this.mediaSource) {\n      const ms = this.mediaSource\n      const onOpen = () => {\n        const costtime = nowTime() - this._st\n        this._logger.debug('MSE OPEN', costtime)\n        ms.removeEventListener('sourceopen', onOpen)\n        this._openPromise.resolve({costtime})\n      }\n      ms.addEventListener('sourceopen', onOpen)\n      this._openPromise = createPublicPromise()\n    }\n\n    return this._openPromise\n  }\n\n  /**\n   * @param { HTMLMediaElement } media\n   * @return { Promise }\n   */\n  async bindMedia (media) {\n    if (this.mediaSource || this.media) await this.unbindMedia()\n\n    const MediaSource = getMediaSource(this._config.perferMMS)\n\n    if (!media || !MediaSource) throw new Error('Param media or MediaSource does not exist')\n    this.media = media\n    const ms = this.mediaSource = new MediaSource()\n    this._st = nowTime()\n\n    const onOpen = () => {\n      const costtime = nowTime() - this._st\n      this._logger.debug('MSE OPEN')\n      ms.removeEventListener('sourceopen', onOpen)\n      URL.revokeObjectURL(media.src)\n      this._openPromise.resolve({costtime})\n    }\n    ms.addEventListener('sourceopen', onOpen)\n\n    this._url = URL.createObjectURL(ms)\n    media.src = this._url\n\n    if (MediaSource.name === 'ManagedMediaSource') {\n      media.disableRemotePlayback = true\n    } else {\n      media.disableRemotePlayback = false\n    }\n\n    return this._openPromise\n  }\n\n  /** @return { Promise } */\n  async unbindMedia () {\n    if (!this._openPromise.used) this._openPromise.resolve()\n    const ms = this.mediaSource\n\n    if (ms) {\n      Object.keys(this._queue).forEach((t) => {\n        const queue = this._queue[t]\n        if (queue) {\n          queue.forEach(x => x.promise?.resolve?.())\n        }\n      })\n\n      const hasMetadata = !!this.media && this.media.readyState >= 1\n      const mseOpen = ms.readyState === 'open'\n\n      if (hasMetadata && mseOpen) {\n        try {\n          ms.endOfStream()\n        } catch (error) {\n          // ignore\n        }\n      }\n\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          ms.removeSourceBuffer(this._sourceBuffer[k])\n        } catch (error) {\n          // ignore\n        }\n      })\n    }\n\n    if (this.media) {\n      this.media.disableRemotePlayback = false\n      this.media.removeAttribute('src')\n      try {\n        this.media.load()\n      } catch (error) {\n        // ignore\n      }\n      this.media = null\n    }\n\n    this.mediaSource = null\n    this._openPromise = createPublicPromise()\n    this._queue = Object.create(null)\n    this._sourceBuffer = Object.create(null)\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   */\n  createSource (type, mimeType) {\n    if (this._sourceBuffer[type] || !this.mediaSource) return\n    let sb\n    try {\n      sb = this._sourceBuffer[type] = this.mediaSource.addSourceBuffer(mimeType)\n    } catch (error) {\n      throw new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_ADD_SB, error)\n    }\n    sb.mimeType = mimeType\n    sb.addEventListener('updateend', this._onSBUpdateEnd.bind(this, type))\n    sb.addEventListener('error', this._onSBUpdateError.bind(this, type))\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  changeType (type, mimeType) {\n    const sb = this._sourceBuffer[type]\n    if (!this.mediaSource || !sb || sb.mimeType === mimeType) return Promise.resolve()\n\n    if (typeof sb.changeType !== 'function') return Promise.reject()\n\n    return this._enqueueOp(type, () => {\n      sb.changeType(mimeType)\n      sb.mimeType = mimeType\n      this._onSBUpdateEnd(type)\n    }, 'changeType', {mimeType})\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  createOrChangeSource (type, mimeType) {\n    this.createSource(type, mimeType)\n    return this.changeType(type, mimeType)\n  }\n\n  /**\n   * @param { string } type\n   * @param { BufferSource } buffer\n   * @return { Promise }\n   */\n  append (type, buffer, context) {\n    if (!buffer || !buffer.byteLength) {\n      return Promise.resolve()\n    }\n\n    if (!this._sourceBuffer[type]) return Promise.resolve()\n\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      this._logger.debug('MSE APPEND START', context)\n      this._opst = nowTime()\n      this._sourceBuffer[type]?.appendBuffer(buffer)\n    }, OP_NAME.APPEND, context)\n\n  }\n\n  /**\n   * @param { string } type\n   * @param { number } startTime\n   * @param { number } endTime\n   * @return { Promise }\n   */\n  remove (type, startTime, endTime, context) {\n    // if (Object.keys(this._sourceBuffer).length === 1) return Promise.resolve()\n    let isInsertHead = false\n    if (this._mseFullFlag[type]) {\n      isInsertHead = true\n    }\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      const sb = this._sourceBuffer[type]\n      if (startTime >= endTime || !sb) {\n        this._onSBUpdateEnd(type)\n        return\n      }\n      this._opst = nowTime()\n      this._logger.debug('MSE REMOVE START', type, startTime, endTime, context)\n      sb.remove(startTime, endTime)\n    }, OP_NAME.REMOVE, context, isInsertHead)\n  }\n\n  clearBuffer (startTime, endTime) {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      p = this.remove(k, startTime, endTime)\n    })\n    return p || Promise.resolve()\n  }\n\n  clearAllBuffer () {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      const sb = this._sourceBuffer[k]\n      p = this.remove(k, 0, Buffer.end(Buffer.get(sb)))\n    })\n    return p\n  }\n\n  clearOpQueues (type, allClear) {\n    this._logger.debug('MSE clearOpQueue START')\n    const queue = this._queue[type]\n    if (allClear && queue) {\n      this._queue[type] = []\n      return\n    }\n    if (!queue || !queue[type] || queue.length < 5) return\n    const initOpque = []\n    queue.forEach(op => {\n      if (op.context && op.context.isinit) {\n        initOpque.push(op)\n      }\n    })\n    this._queue[type] = queue.slice(0, 2)\n    initOpque.length > 0 && this._queue[type].push(...initOpque)\n  }\n\n  /**\n   * @param {EndOfStreamError} [reason]\n   * @returns {Promise}\n   */\n  endOfStream (reason) {\n    if (!this.mediaSource || this.mediaSource.readyState !== 'open') return Promise.resolve()\n    return this._enqueueBlockingOp(() => {\n      const ms = this.mediaSource\n      if (!ms || ms.readyState !== 'open') return\n      this._logger.debug('MSE endOfStream START')\n      if (reason) {\n        ms.endOfStream(reason)\n      } else {\n        ms.endOfStream()\n      }\n    }, 'endOfStream')\n  }\n\n  setLiveSeekableRange (start, end) {\n    const ms = this.mediaSource\n    if (start < 0 || end < start || !ms?.setLiveSeekableRange || ms.readyState !== 'open') return\n    ms.setLiveSeekableRange(start, end)\n  }\n\n  /**\n   * @param {string} type\n   * @returns {?SourceBuffer}\n   */\n  getSourceBuffer (type) {\n    return this._sourceBuffer[type]\n  }\n\n  /**\n   * @param { string } type\n   * @return { TimeRanges | void }\n   */\n  buffered (type) {\n    return Buffer.get(this._sourceBuffer[type])\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferStart (type) {\n    return Buffer.start(this.buffered(type))\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferEnd (type) {\n    return Buffer.end(this.buffered(type))\n  }\n\n  _enqueueOp (type, exec, opName, context, isInsertHead) {\n    if (!this.mediaSource) return Promise.resolve()\n    const queue = this._queue[type] = this._queue[type] || []\n    const op = {\n      exec,\n      promise: createPublicPromise(),\n      opName,\n      context\n    }\n\n    if (isInsertHead) {\n      queue.splice(0, 0, op)\n      this._mseFullFlag[type] = false\n      this._startQueue(type)\n    } else {\n      queue.push(op)\n    }\n\n    if (this.isOpened || this.isEnded) {\n      if (queue.length === 1) {\n        this._startQueue(type)\n      }\n    } else {\n      this._openPromise.then(() => {\n        if (queue.length === 1) {\n          this._startQueue(type)\n        }\n      })\n    }\n\n\n    return op.promise\n  }\n\n  async _enqueueBlockingOp (exec, opName, context) {\n    if (!this.mediaSource) return Promise.resolve()\n    const types = Object.keys(this._sourceBuffer)\n    if (!types.length) {\n      return exec()\n    }\n\n    const waiters = []\n    types.forEach(t => {\n      const queue = this._queue[t]\n      const prom = createPublicPromise()\n      waiters.push(prom)\n      queue.push({exec: () => {\n        prom.resolve()}, promise: prom, opName, context})\n      if (queue.length === 1) {\n        this._startQueue(t)\n      }\n    })\n\n    return Promise.all(waiters).then(() => {\n      try {\n        return exec()\n      } finally {\n        types.forEach(t => {\n          const queue = this._queue[t]\n          const sb = this._sourceBuffer[t]\n          queue?.shift()\n          if (!sb || !sb.updating) {\n            this._startQueue(t)\n          }\n        })\n      }\n    })\n  }\n\n  _startQueue (type) {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op && !this._mseFullFlag[type]) {\n        try {\n          op.exec()\n        } catch (error) {\n          if (error && error.message && error.message.indexOf('SourceBuffer is full') >= 0) {\n            this._mseFullFlag[type] = true\n            this._logger.error('[MSE error],  context,', op.context, ' ,name,', op.opName, ',err,SourceBuffer is full')\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_FULL, error))\n          } else {\n            this._logger.error(error)\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_OTHER, error))\n            queue.shift()\n            this._startQueue(type)\n          }\n        }\n      }\n    }\n  }\n\n  _onSBUpdateEnd = (type) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (!(op?.opName === OP_NAME.UPDATE_DURATION)) {\n        queue.shift()\n      }\n      if (op) {\n        const costtime = nowTime() - this._opst\n        this._logger.debug('UpdateEnd', op.opName, costtime, op.context)\n        op.promise.resolve({name: op.opName, context: op.context, costtime})\n        this._startQueue(type)\n      }\n    }\n  }\n\n  _onSBUpdateError = (type, event) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op) {\n        this._logger.error('UpdateError', type, op.opName, op.context)\n        op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_APPEND_BUFFER, event))\n        // Do not shift from queue, 'updateend' event will fire next\n      }\n    }\n  }\n\n  /**\n   * @param {string} [mime='video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"']\n   * @returns {boolean}\n   */\n  static isSupported (mime = 'video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"') {\n    const MediaSource = getMediaSource()\n    if (!MediaSource) return false\n    try {\n      return MediaSource.isTypeSupported(mime)\n    } catch (error) {\n      this._logger.error(mime, error)\n      return false\n    }\n  }\n\n  setTimeoffset (type, timestampOffset, context) {\n    return this._enqueueOp(type, () => {\n      if (timestampOffset < 0) {\n        timestampOffset += 0.001\n      }\n      this._sourceBuffer[type].timestampOffset = timestampOffset\n      this._onSBUpdateEnd(type)\n    }, 'setTimeoffset', context)\n  }\n\n  /** *重置decode时间戳 */\n  abort (type, context) {\n    if (!this.isOpened) {\n      return Promise.resolve()\n    }\n    return this._enqueueOp(type, () => {\n      this._sourceBuffer[type].abort()\n      this._onSBUpdateEnd(type)\n    }, 'abort', context)\n  }\n}\n","export const LoaderType = {\n  FETCH: 'fetch',\n  XHR: 'xhr'\n}\n\nexport const ResponseType = {\n  ARRAY_BUFFER: 'arraybuffer',\n  TEXT: 'text',\n  JSON: 'json'\n}\n","import { LoaderType } from './types'\n\nexport class NetError extends Error {\n  retryCount = 0\n  isTimeout = false\n  loaderType = LoaderType.FETCH\n  startTime = 0\n  endTime = 0\n  options = {}\n\n  constructor (url, request, response, msg) {\n    super(msg)\n    this.url = url\n    this.request = request\n    this.response = response\n  }\n}\n","const toString = Object.prototype.toString\n\nexport function isObject (a) {\n  return a !== null && typeof a === 'object'\n}\n\nexport function isPlainObject (val) {\n  if (toString.call(val) !== '[object Object]') {\n    return false\n  }\n\n  const prototype = Object.getPrototypeOf(val)\n  return prototype === null || prototype === Object.prototype\n}\n\nexport function isDate (a) {\n  return toString.call(a) === '[object Date]'\n}\n\nexport function isNumber (n) {\n  return typeof n === 'number' && !Number.isNaN(n)\n}\n","import { isDate, isObject } from '../is'\n\nexport function getRangeValue (value) {\n  if (!value || value[0] === null || value[0] === undefined || (value[0] === 0 && (value[1] === null || value[1] === undefined))) {\n    return\n  }\n  let ret = 'bytes=' + value[0] + '-'\n  if (value[1]) ret += value[1]\n  return ret\n}\n\nfunction encode (val) {\n  return encodeURIComponent(val)\n    .replace(/%3A/gi, ':')\n    .replace(/%24/g, '$')\n    .replace(/%2C/gi, ',')\n    .replace(/%20/g, '+')\n    .replace(/%5B/gi, '[')\n    .replace(/%5D/gi, ']')\n}\n\nexport function setUrlParams (url, params) {\n  if (!url) return\n  if (!params) return url\n  let v\n  const str = Object.keys(params).map(k => {\n    v = params[k]\n    if (v === null || v === undefined) return\n    if (Array.isArray(v)) {\n      k = k + '[]'\n    } else {\n      v = [v]\n    }\n\n    return v.map(x => {\n      if (isDate(x)) {\n        x = x.toISOString()\n      } else if (isObject(x)) {\n        x = JSON.stringify(x)\n      }\n      return `${encode(k)}=${encode(x)}`\n    }).join('&')\n  }).filter(Boolean).join('&')\n\n  if (str) {\n    const hashIndex = url.indexOf('#')\n    if (hashIndex !== -1) {\n      url = url.slice(0, hashIndex)\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + str\n  }\n\n  return url\n}\n\nexport function createResponse (\n  data,\n  done,\n  response,\n  contentLength,\n  age,\n  startTime,\n  firstByteTime,\n  index,\n  range,\n  vid,\n  priOptions\n) {\n  age = (age !== null && age !== undefined) ? parseFloat(age) : null\n  contentLength = parseInt(contentLength || '0', 10)\n  if (Number.isNaN(contentLength)) contentLength = 0\n  const options = { range, vid, index, contentLength, age, startTime, firstByteTime, endTime: Date.now(), priOptions }\n  return { data, done, options, response }\n}\n\nexport function calculateSpeed (byteLen, millisec) {\n  return Math.round(byteLen * 8 * 1000 / millisec / 1024)\n}\n","export const EVENT = {\n  ERROR: 'error',\n\n  TTFB: 'core.ttfb',\n  LOAD_START: 'core.loadstart',\n  LOAD_RESPONSE_HEADERS: 'core.loadresponseheaders',\n  LOAD_COMPLETE: 'core.loadcomplete',\n  LOAD_RETRY: 'core.loadretry',\n  SOURCEBUFFER_CREATED: 'core.sourcebuffercreated',\n  ANALYZE_DURATION_EXCEEDED: 'core.analyzedurationexceeded',\n  REMOVE_BUFFER: 'core.removebuffer',\n  BUFFEREOS: 'core.buffereos',\n  KEYFRAME: 'core.keyframe',\n  METADATA_PARSED: 'core.metadataparsed',\n  SEI: 'core.sei',\n  SEI_IN_TIME: 'core.seiintime',\n  FLV_SCRIPT_DATA: 'core.flvscriptdata',\n  LOWDECODE: 'core.lowdecode',\n  SWITCH_URL_SUCCESS: 'core.switchurlsuccess',\n  SWITCH_URL_FAILED: 'core.switchurlfailed',\n  SPEED: 'core.speed',\n  HLS_MANIFEST_LOADED: 'core.hlsmanifestloaded',\n  HLS_LEVEL_LOADED: 'core.hlslevelloaded',\n  DEMUXED_TRACK:'core.demuxedtrack',\n\n  STREAM_EXCEPTION: 'core.streamexception',\n  LARGE_AV_FIRST_FRAME_GAP_DETECT: 'LARGE_AV_FIRST_FRAME_GAP_DETECT',\n  LARGE_VIDEO_DTS_GAP_DETECT: 'LARGE_VIDEO_DTS_GAP_DETECT',\n  LARGE_AUDIO_DTS_GAP_DETECT: 'LARGE_AUDIO_DTS_GAP_DETECT',\n  AUDIO_GAP_DETECT: 'AUDIO_GAP_DETECT',\n  AUDIO_OVERLAP_DETECT: 'AUDIO_OVERLAP_DETECT',\n  MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT: 'MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT',\n  REAL_TIME_SPEED: 'real_time_speed'\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nconst CACHESIZE = 2 * 1024 * 1024\nexport class FetchLoader extends EventEmitter {\n  _abortController = null\n  _timeoutTimer = null\n  _reader = null\n  _response = null\n  _aborted = false\n  _index = -1\n  _range = null\n  _receivedLength = 0\n  _running = false\n  _logger = null\n  _vid = ''\n  _onProcessMinLen = 0\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n  constructor () {\n    super()\n  }\n\n  load ({\n    url,\n    vid,\n    timeout, // ms\n    responseType,\n    onProgress,\n    index,\n    onTimeout,\n    onCancel,\n    range,\n    transformResponse,\n    request,\n    params,\n    logger,\n\n    method,\n    headers,\n    body,\n    mode,\n    credentials,\n    cache,\n    redirect,\n    referrer,\n    referrerPolicy,\n    onProcessMinLen,\n    priOptions\n  }) {\n    this._logger = logger\n    this._aborted = false\n    this._onProcessMinLen = onProcessMinLen\n    this._onCancel = onCancel\n    this._abortController = typeof AbortController !== 'undefined' && new AbortController()\n    this._running = true\n    this._index = index\n    this._range = range || [0, 0]\n    this._vid = vid || url\n    this._priOptions = priOptions || {}\n    const init = {\n      method,\n      headers,\n      body,\n      mode,\n      credentials,\n      cache,\n      redirect,\n      referrer,\n      referrerPolicy,\n      signal: this._abortController?.signal\n    }\n\n    let isTimeout = false\n    clearTimeout(this._timeoutTimer)\n\n    url = setUrlParams(url, params)\n\n    const rangeValue = getRangeValue(range)\n    if (rangeValue) {\n      if (request) {\n        headers = request.headers\n      } else {\n        headers = init.headers = init.headers || (Headers ? new Headers() : {})\n      }\n      if (Headers && headers instanceof Headers) {\n        headers.append('Range', rangeValue)\n      } else {\n        headers.Range = rangeValue\n      }\n    }\n\n    if (timeout) {\n      this._timeoutTimer = setTimeout(() => {\n        isTimeout = true\n        this.cancel()\n        if (onTimeout) {\n          const error = new NetError(url, init, null, 'timeout')\n          error.isTimeout = true\n          onTimeout(error, {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n      }, timeout)\n    }\n\n    const startTime = Date.now()\n    this._logger.debug('[fetch load start], index,', index, ',range,', range)\n    return new Promise((resolve, reject) => {\n      fetch(request || url, request ? undefined : init).then(async (response) => {\n        clearTimeout(this._timeoutTimer)\n        this._response = response\n        if (this._aborted || !this._running) return\n        if (transformResponse) {\n          response = transformResponse(response, url) || response\n        }\n        if (!response.ok) {\n          throw new NetError(url, init, response, 'bad network response')\n        }\n\n        const firstByteTime = Date.now()\n        let data\n        if (responseType === ResponseType.TEXT) {\n          data = await response.text()\n          this._running = false\n        } else if (responseType === ResponseType.JSON) {\n          data = await response.json()\n          this._running = false\n        } else {\n          if (onProgress) {\n            this.resolve = resolve\n            this.reject = reject\n            this._loadChunk(response, onProgress, startTime, firstByteTime)\n            return\n          } else {\n            data = await response.arrayBuffer()\n            data = new Uint8Array(data)\n            this._running = false\n            const costTime = Date.now() - startTime\n            const speed = calculateSpeed(data.byteLength, costTime)\n            this.emit(EVENT.REAL_TIME_SPEED, {speed,len: data.byteLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n          }\n        }\n        this._logger.debug('[fetch load end], index,', index, ',range,', range)\n        resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          startTime,\n          firstByteTime,\n          index,\n          range,\n          this._vid,\n          this._priOptions\n        ))\n      }).catch((error) => {\n        clearTimeout(this._timeoutTimer)\n        this._running = false\n        if (this._aborted && !isTimeout) return\n        error = error instanceof NetError ? error : new NetError(url, init, null, error?.message)\n        error.startTime = startTime\n        error.endTime = Date.now()\n        error.isTimeout = isTimeout\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        reject(error)\n      })\n    })\n  }\n\n  async cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._running = false\n    if (this._response) {\n      try {\n        // await this._response.body.cancel()\n        if (this._reader) {\n          await this._reader.cancel()\n        }\n      } catch (error) {\n        // ignore\n      }\n      this._response = this._reader = null\n    }\n\n    if (this._abortController) {\n      try {\n        this._abortController.abort()\n      } catch (error) {\n        // ignore\n      }\n      this._abortController = null\n    }\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n  }\n\n  _loadChunk (response, onProgress, st, firstByteTime) {\n    if (!response.body || !response.body.getReader) {\n      this._running = false\n      const err = new NetError(response.url, '', response, 'onProgress of bad response.body.getReader')\n      err.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      this.reject(err)\n      return\n    }\n    if (this._onProcessMinLen > 0) {\n      this._cache = new Uint8Array(CACHESIZE)\n      this._writeIdx = 0\n    }\n    const reader = this._reader = response.body.getReader()\n    let data\n\n    let startTime\n    let endTime\n    const pump = async () => {\n      startTime = Date.now()\n      try {\n        data = await reader.read()\n        endTime = Date.now()\n      } catch (e) {\n        // request aborted\n        endTime = Date.now()\n        if (!this._aborted) {\n          this._running = false\n          e.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n          this.reject(e)\n        }\n        return\n      }\n      const startRange = this._range?.length > 0 ? this._range[0] : 0\n      const startByte = startRange + this._receivedLength\n      if (this._aborted) {\n        this._running = false\n        onProgress(undefined, false, { range: [startByte, startByte], vid: this._vid, index: this._index, startTime, endTime, st, firstByteTime, priOptions:this._priOptions }, response)\n        return\n      }\n      const curLen = data.value ? data.value.byteLength : 0\n      this._receivedLength += curLen\n      this._logger.debug('【fetchLoader,onProgress call】,task,', this._range, ', start,', startByte, ', end,', startRange + this._receivedLength, ', done,', data.done)\n      let retData\n      if (this._onProcessMinLen > 0) {\n        if (this._writeIdx + curLen >= this._onProcessMinLen || data.done) {\n          retData = new Uint8Array(this._writeIdx + curLen)\n          retData.set(this._cache.slice(0, this._writeIdx), 0)\n          curLen > 0 && retData.set(data.value, this._writeIdx)\n          this._writeIdx = 0\n          this._logger.debug('【fetchLoader,onProgress enough】,done,', data.done, ',len,', retData.byteLength, ', writeIdx,', this._writeIdx)\n        } else {\n          if (curLen > 0 && this._writeIdx + curLen < CACHESIZE) {\n            this._cache.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            this._logger.debug('【fetchLoader,onProgress cache】,len,', curLen, ', writeIdx,', this._writeIdx)\n          } else if (curLen > 0) {\n            const temp = new Uint8Array(this._writeIdx + curLen + 2048)\n            this._logger.debug('【fetchLoader,onProgress extra start】,size,', this._writeIdx + curLen + 2048, ', datalen,', curLen, ', writeIdx,', this._writeIdx)\n            temp.set(this._cache.slice(0, this._writeIdx), 0)\n            curLen > 0 && temp.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            delete this._cache\n            this._cache = temp\n            this._logger.debug('【fetchLoader,onProgress extra end】,len,', curLen, ', writeIdx,', this._writeIdx)\n          }\n        }\n      } else {\n        retData = data.value\n      }\n      if (retData && retData.byteLength > 0 || data.done) {\n        onProgress(retData, data.done, {\n          range: [this._range[0] + this._receivedLength - (retData ? retData.byteLength : 0), this._range[0] + this._receivedLength],\n          vid: this._vid,\n          index: this._index,\n          startTime,\n          endTime,\n          st,\n          firstByteTime,\n          priOptions:this._priOptions\n        }, response)\n      }\n      if (!data.done) {\n        pump()\n      } else {\n        const costTime = Date.now() - st\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed,len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n        this._running = false\n        this._logger.debug('[fetchLoader onProgress end],task,', this._range, ',done,', data.done)\n        this.resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          st,\n          firstByteTime,\n          this._index,\n          this._range,\n          this._vid,\n          this._priOptions\n        ))\n      }\n    }\n    pump()\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  static isSupported () {\n    return !!(typeof fetch !== 'undefined')\n  }\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nexport class XhrLoader extends EventEmitter {\n\n  _xhr = null\n  _aborted = false\n  _timeoutTimer = null\n  _range = null\n  _receivedLength = 0\n  _url = null\n  _onProgress = null\n  _index = -1\n  _headers = null\n  // _chunkSizeKBList = [\n  //   128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192\n  // ]\n\n  _currentChunkSizeKB = 384\n  _timeout = null\n  _xhr = null\n  _withCredentials = null\n  _startTime = -1\n  // _speedSampler = new SpeedSampler()\n  _loadCompleteResolve = null\n  _loadCompleteReject = null\n  _runing = false\n  _logger = false\n  _vid = ''\n  _responseType\n  _credentials\n  _method\n  _transformResponse\n  _firstRtt\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n\n  constructor () {\n    super()\n  }\n\n  load (req) {\n    clearTimeout(this._timeoutTimer)\n    this._logger = req.logger\n    this._range = req.range\n    this._onProgress = req.onProgress\n    this._index = req.index\n    this._headers = req.headers\n    this._withCredentials = req.credentials === 'include' || req.credentials === 'same-origin'\n    this._body = req.body || null\n    req.method && (this._method = req.method)\n    this._timeout = req.timeout || null\n    this._runing = true\n    this._vid = req.vid || req.url\n    this._responseType = req.responseType\n    this._firstRtt = -1\n    this._onTimeout = req.onTimeout\n    this._onCancel = req.onCancel\n    this._request = req.request\n    this._priOptions = req.priOptions || {}\n    this._logger.debug('【xhrLoader task】, range', this._range)\n\n    this._url = setUrlParams(req.url, req.params)\n\n    const startTime = Date.now()\n    return new Promise((resolve, reject) => {\n      this._loadCompleteResolve = resolve\n      this._loadCompleteReject = reject\n      this._startLoad()\n    }).catch((error) => {\n      clearTimeout(this._timeoutTimer)\n      this._runing = false\n      if (this._aborted) return\n      error = error instanceof NetError ? error : new NetError(this._url, this._request)\n      error.startTime = startTime\n      error.endTime = Date.now()\n      error.options = {index: this._index, vid: this._vid, priOptions: this._priOptions}\n      throw error\n    })\n  }\n\n  _startLoad () {\n    let range = null\n    if (this._responseType === ResponseType.ARRAY_BUFFER && this._range && this._range.length > 1) {\n      if (this._onProgress) {\n        this._firstRtt = -1\n        const chunkSize = this._currentChunkSizeKB * 1024\n        const from = this._range[0] + this._receivedLength\n        let to = this._range[1]\n        if (chunkSize < this._range[1] - from) {\n          to = from + chunkSize\n        }\n        range = [from, to]\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', SubRange, ', range)\n      } else {\n        range = this._range\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', allRange, ', range)\n      }\n    }\n    this._internalOpen(range)\n  }\n\n  _internalOpen (range) {\n    try {\n      this._startTime = Date.now()\n      const xhr = this._xhr = new XMLHttpRequest()\n      xhr.open(this._method || 'GET', this._url, true)\n      xhr.responseType = this._responseType\n      this._timeout && (xhr.timeout = this._timeout)\n      xhr.withCredentials = this._withCredentials\n      xhr.onload = this._onLoad.bind(this)\n      xhr.onreadystatechange = this._onReadyStatechange.bind(this)\n      xhr.onerror = (errorEvent) => {\n        this._running = false\n        const error = new NetError(this._url, this._request, errorEvent?.currentTarget?.response, ('xhr.onerror.status:' + errorEvent?.currentTarget?.status + ',statusText,' + errorEvent?.currentTarget?.statusText))\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      xhr.ontimeout = (event) => {\n        this.cancel()\n        const error = new NetError(this._url, this._request, {status:408}, 'timeout')\n        if (this._onTimeout) {\n          error.isTimeout = true\n          this._onTimeout(error,{index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      const headers = this._headers || {}\n      const rangeValue = getRangeValue(range)\n      if (rangeValue) {\n        headers.Range = rangeValue\n      }\n      if (headers) {\n        Object.keys(headers).forEach(k => {\n          xhr.setRequestHeader(k, headers[k])\n        })\n      }\n      this._logger.debug('[xhr.send->] tast,', this._range, ',load sub range, ', range)\n      xhr.send(this._body)\n    } catch (e) {\n      e.options = {index: this._index, range, vid: this._vid, priOptions: this._priOptions}\n      this._loadCompleteReject(e)\n    }\n  }\n\n  _onReadyStatechange (e) {\n    const xhr = e.target\n    if (xhr.readyState === 2) {\n      this._firstRtt < 0 && (this._firstRtt = Date.now())\n    }\n  }\n\n  _onLoad (e) {\n    const status = e.target.status\n    if (status < 200 || status > 299) {\n      const error = new NetError(this._url, null, { ...e.target.response, status }, 'bad response,status:' + status)\n      error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      return this._loadCompleteReject(error)\n    }\n    let data = null\n    let done = false\n    let byteStart\n    const startRange = (this._range?.length > 0 ? this._range [0] : 0 )\n    if (this._responseType === ResponseType.ARRAY_BUFFER) {\n      const chunk = new Uint8Array(e.target.response)\n      byteStart = startRange + this._receivedLength\n      if (chunk && chunk.byteLength > 0) {\n        this._receivedLength += chunk.byteLength\n        const costTime = Date.now() - this._startTime\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed, len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: [byteStart, startRange + this._receivedLength], priOptions: this._priOptions})\n      }\n      data = chunk\n      if (this._range?.length > 1 && this._range[1] && this._receivedLength < this._range[1] - this._range[0]) {\n        done = false\n      } else {\n        done = true\n      }\n      this._logger.debug('[xhr load done->], tast :', this._range, ', start', byteStart, 'end ', startRange + this._receivedLength, ',dataLen,', (chunk ? chunk.byteLength : 0), ',receivedLength', this._receivedLength, ',index,', this._index, ', done,', done)\n    } else {\n      done = true\n      data = e.target.response\n    }\n    let response = {\n      ok: status >= 200 && status < 300,\n      status,\n      statusText: this._xhr.statusText,\n      url: this._xhr.responseURL,\n      headers: this._getHeaders(this._xhr),\n      body: this._xhr.response\n    }\n    if (this._transformResponse) {\n      response = this._transformResponse(response, this._url) || response\n    }\n    if (this._onProgress) {\n      this._onProgress(data, done, { index: this._index, vid: this._vid, range: [byteStart, startRange + this._receivedLength], startTime: this._startTime, endTime: Date.now(), priOptions: this._priOptions }, response)\n    }\n\n    if (!done) {\n      this._startLoad()\n    } else {\n      this._runing = false\n      this._loadCompleteResolve && this._loadCompleteResolve(createResponse(\n        this._onProgress ? null : data,\n        done,\n        response,\n        response.headers['content-length'],\n        response.headers.age,\n        this._startTime,\n        this._firstRtt,\n        this._index,\n        this._range,\n        this._vid,\n        this._priOptions\n      ))\n    }\n  }\n\n  cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._runing = false\n    super.removeAllListeners()\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n    if (this._xhr) {\n      return this._xhr.abort()\n    }\n  }\n\n  static isSupported () {\n    return typeof XMLHttpRequest !== 'undefined'\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  _getHeaders (xhr) {\n    const headerLines = xhr.getAllResponseHeaders().trim().split('\\r\\n')\n    const headers = {}\n    for (const header of headerLines) {\n      const parts = header.split(': ')\n      headers[parts[0].toLowerCase()] = parts.slice(1).join(': ')\n    }\n    return headers\n  }\n}\n","import { FetchLoader } from './fetch'\nimport { XhrLoader } from './xhr'\nimport { LoaderType } from './types'\nimport { createPublicPromise } from '../utils'\nimport { Logger } from '../logger'\n\nexport class Task {\n  constructor (type, config) {\n    this.promise = createPublicPromise()\n    this.alive = !!config.onProgress\n    !config.logger && (config.logger = new Logger('Loader'))\n    this._loaderType = type\n    this._loader = type === LoaderType.FETCH && typeof fetch !== 'undefined' ? new FetchLoader() : new XhrLoader()\n    this._config = config\n    this._retryCount = 0\n    this._retryTimer = null\n    this._canceled = false\n    this._retryCheckFunc = config.retryCheckFunc\n    this._logger = config.logger\n  }\n\n  exec () {\n    const {\n      retry,\n      retryDelay,\n      onRetryError,\n      transformError,\n      ...rest\n    } = this._config\n\n    const request = async () => {\n      try {\n        const response = await this._loader.load(rest)\n        this.promise.resolve(response)\n      } catch (e) {\n        this._loader.running = false\n        this._logger.debug('[task request catch err]', e)\n        if (this._canceled) return\n\n        e.loaderType = this._loaderType\n        e.retryCount = this._retryCount\n\n        let error = e\n        if (transformError) {\n          error = transformError(error) || error\n        }\n\n        if (onRetryError && this._retryCount > 0) onRetryError(error, this._retryCount, {index: rest.index, vid: rest.vid, range: rest.range, priOptions: rest.priOptions})\n\n        this._retryCount++\n        let isRetry = true\n        if (this._retryCheckFunc) {\n          isRetry = this._retryCheckFunc(e)\n        }\n        if (isRetry && this._retryCount <= retry) {\n          clearTimeout(this._retryTimer)\n          this._logger.debug('[task request setTimeout],retry', this._retryCount, ',retry range,', rest.range)\n          this._retryTimer = setTimeout(request, retryDelay)\n          return\n        }\n        this.promise.reject(error)\n      }\n    }\n\n    request()\n    return this.promise\n  }\n\n  async cancel () {\n    clearTimeout(this._retryTimer)\n    this._canceled = true\n    this._loader.running = false\n    return this._loader.cancel()\n  }\n\n  get running () {\n    return this._loader && this._loader.running\n  }\n\n  get loader () {\n    return this._loader\n  }\n}\n","export function isMediaPlaying (media) {\n  return media && !media.paused && !media.ended && media.playbackRate !== 0 && media.readyState !== 0\n}\n\nexport function getVideoPlaybackQuality (video) {\n  if (!video) return {}\n  if (typeof video.getVideoPlaybackQuality === 'function') {\n    const info = video.getVideoPlaybackQuality()\n    return {\n      droppedVideoFrames: info.droppedVideoFrames || info.corruptedVideoFrames,\n      totalVideoFrames: info.totalVideoFrames,\n      creationTime: info.creationTime\n    }\n  }\n\n  return {\n    droppedVideoFrames: video.webkitDroppedFrameCount,\n    totalVideoFrames: video.webkitDecodedFrameCount,\n    creationTime: performance.now()\n  }\n}\n\n/**\n * @param {Array.<Uint8Array>} arr\n * @returns\n */\nexport function concatUint8Array (...arr) {\n  arr = arr.filter(Boolean)\n  if (arr.length < 2) return arr[0]\n  const data = new Uint8Array(arr.reduce((p, c) => p + c.byteLength, 0))\n  let prevLen = 0\n  arr.forEach((d) => {\n    data.set(d, prevLen)\n    prevLen += d.byteLength\n  })\n  return data\n}\n\nexport function sleep (t = 0) {\n  return new Promise((resolve) => setTimeout(resolve, t))\n}\n","import { FetchLoader } from './fetch'\nimport { LoaderType, ResponseType } from './types'\nimport { getConfig } from './config'\nimport { Task } from './task'\nimport { isPlainObject } from '../is'\nimport { sleep } from '../streaming-helper'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\n\nexport {\n  LoaderType,\n  ResponseType\n}\n\nexport class NetLoader extends EventEmitter {\n  type = LoaderType.FETCH\n\n  _queue = []\n\n  _alive = []\n\n  _currentTask = null\n\n  _finnalUrl = ''\n\n  _config\n\n  constructor (cfg) {\n    super(cfg)\n    this._config = getConfig(cfg)\n    if (\n      this._config.loaderType === LoaderType.XHR ||\n      !FetchLoader.isSupported()\n    ) {\n      this.type = LoaderType.XHR\n    }\n    this.log = cfg.logger\n  }\n\n  isFetch () {\n    return this.type === LoaderType.FETCH\n  }\n\n  static isFetchSupport () {\n    return FetchLoader.isSupported()\n  }\n\n  load (url, config = {}) {\n    if (typeof url === 'string' || !url) {\n      config.url = url || config.url || this._config.url\n    } else {\n      config = url\n    }\n\n    config = Object.assign({}, this._config, config)\n\n    if (config.params) config.params = Object.assign({}, config.params)\n    if (config.headers && isPlainObject(config.headers)) config.headers = Object.assign({}, config.headers)\n    if (config.body && isPlainObject(config.body)) config.body = Object.assign({}, config.body)\n\n    if (config.transformRequest) {\n      config = config.transformRequest(config) || config\n    }\n    config.logger = this.log\n\n    const task = new Task(this.type, config)\n    task.loader.on(EVENT.REAL_TIME_SPEED, (data) => {\n      this.emit(EVENT.REAL_TIME_SPEED, data)\n    })\n    this._queue.push(task)\n    if (this._queue.length === 1 && (!this._currentTask || !this._currentTask.running)) {\n      this._processTask()\n    }\n\n    return task.promise\n  }\n\n  async cancel () {\n    const cancels = this._queue.map(t => t.cancel()).concat(this._alive.map(t => t.cancel()))\n    if (this._currentTask) {\n      cancels.push(this._currentTask.cancel())\n    }\n    this._queue = []\n    this._alive = []\n    await Promise.all(cancels)\n    await sleep()\n  }\n\n  _processTask () {\n    this._currentTask = this._queue.shift()\n    if (!this._currentTask) return\n\n    if (this._currentTask.alive) {\n      this._alive.push(this._currentTask)\n    }\n    const req = this._currentTask.exec().catch(e => {})\n\n    if (!(req && typeof req.finally === 'function')) return\n\n    req.finally(() => {\n      if (this._currentTask?.alive && this._alive?.length > 0) {\n        this._alive = this._alive.filter(task => task && task !== this._currentTask)\n      }\n      this._processTask()\n    })\n\n  }\n}\n","import { LoaderType, ResponseType } from './types'\n\nexport function getConfig (cfg) {\n  return {\n    loaderType: LoaderType.FETCH,\n    retry: 0,\n    retryDelay: 0, // ms\n    timeout: 0,\n    request: null, // Request\n    onTimeout: undefined,\n    onProgress: undefined,\n    onRetryError: undefined,\n    transformRequest: undefined,\n    transformResponse: undefined,\n    transformError: undefined,\n    responseType: ResponseType.TEXT,\n    range: undefined,\n    url: '',\n    params: undefined,\n    method: 'GET',\n    headers: {},\n    body: undefined,\n    mode: undefined,\n    credentials: undefined,\n    cache: undefined,\n    redirect: undefined,\n    referrer: undefined,\n    referrerPolicy: undefined,\n    integrity: undefined,\n    onProcessMinLen: 0,\n    ...cfg\n  }\n}\n","import { Buffer } from '../buffer'\n\nexport class GapService {\n  _prevCurrentTime = 0\n\n  do (media, maxJumpDistance = 3, isLive, seekThreshold = 1) {\n    if (!media) return\n\n    const currentTime = media.currentTime\n    let jumpTo = 0\n\n    if (this._prevCurrentTime === currentTime) {\n      const info = Buffer.info(Buffer.get(media), currentTime)\n      if (!info.buffers.length) return\n\n      if (\n        (isLive && info.nextStart) ||\n        (info.nextStart && info.nextStart - currentTime < maxJumpDistance)\n      ) {\n        jumpTo = info.nextStart + 0.1\n      } else if (info.end && info.end - currentTime > seekThreshold && !media.seeking) {\n        jumpTo = currentTime + 0.1\n      }\n    }\n\n    this._prevCurrentTime = currentTime\n\n    if (jumpTo && currentTime !== jumpTo) {\n      media.currentTime = jumpTo\n    }\n  }\n}\n","import { EVENT } from '../event'\n\nexport class SeiService {\n  _seiSet = new Set()\n\n  constructor (emitter) {\n    this.emitter = emitter\n\n    emitter.on(EVENT.SEI, sei => {\n      if (sei) this._seiSet.add(sei)\n    })\n  }\n\n  throw (currentTime, isLive) {\n    if (currentTime === null || currentTime === undefined || !this._seiSet.size) return\n    const min = currentTime - 0.2\n    const max = currentTime + 0.2\n    const toThrow = []\n    this._seiSet.forEach(sei => {\n      if (sei.time >= min && sei.time <= max) {\n        toThrow.push(sei)\n      }\n    })\n\n    toThrow.forEach(sei => {\n      this._seiSet.delete(sei)\n      this.emitter.emit(EVENT.SEI_IN_TIME, sei)\n    })\n\n    if (!isLive) return\n\n    this._seiSet.forEach(s => {\n      if (s.time < currentTime - 5) {\n        this._seiSet.delete(s)\n      }\n    })\n  }\n\n  reset () {\n    this._seiSet.clear()\n  }\n}\n","export class BandwidthService {\n  _chunkSpeeds = [] // bps\n  _speeds = [] // bps\n\n  addRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._speeds.push(8000 * totalByte / ms)\n    this._speeds = this._speeds.slice(-3)\n  }\n\n  addChunkRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._chunkSpeeds.push(8000 * totalByte / ms)\n    this._chunkSpeeds = this._chunkSpeeds.slice(-100)\n  }\n\n  getAvgSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds.reduce((a, c) => (a += c)) / this._speeds.length\n    }\n    return this._chunkSpeeds.reduce((a, c) => (a += c)) / this._chunkSpeeds.length\n  }\n\n  getLatestSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds[this._speeds.length - 1]\n    }\n    return this._chunkSpeeds[this._chunkSpeeds.length - 1]\n  }\n\n  reset () {\n    this._chunkSpeeds = []\n    this._speeds = []\n  }\n}\n","import { EVENT } from 'xgplayer-streaming-shared'\n\nclass Stats {\n  encodeType = '' // hevc | avc\n  audioCodec = ''\n  videoCodec = ''\n  domain = '' // stream url domain\n  fps = 0\n  bitrate = 0 // 最新1s下载数据的码率\n  width = 0\n  height = 0\n  samplerate = 0\n  channelCount = 0\n  gop = 0 // 第一个gop帧数\n\n  _bitsAccumulateSize = 0\n  _bitsAccumulateDuration = 0\n  _startGopId = -1\n\n  constructor (timescale) {\n    this._timescale = timescale\n  }\n\n  getStats () {\n    return {\n      encodeType: this.encodeType,\n      audioCodec: this.audioCodec,\n      videoCodec: this.videoCodec,\n      domain: this.domain,\n      fps: this.fps,\n      bitrate: this.bitrate,\n      width: this.width,\n      height: this.height,\n      samplerate: this.samplerate,\n      channelCount: this.channelCount,\n      gop: this.gop\n    }\n  }\n\n  setEncodeType (encode) {\n    this.encodeType = encode\n  }\n\n  setFpsFromScriptData ({data}) {\n    const fps = data?.onMetaData?.framerate\n    if (fps && fps > 0 && fps < 100) {\n      this.fps = fps\n    }\n  }\n\n  setVideoMeta (track) {\n    this.width = track.width\n    this.height = track.height\n    this.videoCodec = track.codec\n    this.encodeType = track.codecType\n    if (track.fpsNum && track.fpsDen) {\n      const fps = track.fpsNum / track.fpsDen\n      if (fps > 0 && fps < 100) {\n        this.fps = fps\n      }\n    }\n  }\n\n  setAudioMeta (track) {\n    this.audioCodec = track.codec\n    this.samplerate = track.sampleRate\n    this.channelCount = track.channelCount\n  }\n\n  setDomain (responseUrl) {\n    this.domain = responseUrl.split('/').slice(2, 3)[0]\n  }\n\n  updateBitrate (samples) {\n    if (!this.fps || this.fps >= 100) {\n      if (samples.length) {\n        const duration = samples.reduce((a,b) => a += b.duration, 0) / samples.length\n        this.fps = Math.round(this._timescale / duration)\n      }\n    }\n    samples.forEach(sample => {\n      if (this._startGopId === -1) {\n        this._startGopId = sample.gopId\n      }\n      if (sample.gopId === this._startGopId) {\n        this.gop++\n      }\n      this._bitsAccumulateDuration += sample.duration / (this._timescale / 1000)\n      this._bitsAccumulateSize += sample.units.reduce((a, c) => (a += c.length), 0)\n      if (this._bitsAccumulateDuration >= 1000) {\n        this.bitrate = this._bitsAccumulateSize * 8\n        this._bitsAccumulateDuration = 0\n        this._bitsAccumulateSize = 0\n      }\n    })\n  }\n}\n\n\n/**\n * @typedef {Object} StatsInfo\n * @property {number} downloadSpeed\n * @property {number} avgSpeed\n * @property {number} currentTime\n * @property {number} bufferEnd\n * @property {number} decodeFps\n * @property {string} encodeType\n * @property {string} audioCodec\n * @property {string} videoCodec\n * @property {string} domain\n * @property {number} fps\n * @property {number} bitrate\n * @property {number} width\n * @property {number} height\n * @property {number} samplerate\n * @property {number} channelCount\n * @property {number} gop\n */\nclass MediaStatsService {\n\n  _core = null\n\n  _samples = []\n\n  constructor (core, timescale = 1000) {\n    this._core = core\n    this._timescale = timescale\n    this._stats = new Stats(timescale)\n    this._bindEvents()\n  }\n\n\n  /** @returns {StatsInfo} */\n  getStats () {\n    const { currentTime = 0, decodeFps = 0 } = this._core?.media || {}\n    return {\n      ...this._stats.getStats(),\n      downloadSpeed: this._core?.speedInfo?.().speed || 0,\n      avgSpeed: this._core?.speedInfo?.().avgSpeed || 0,\n      currentTime,\n      bufferEnd: this._core?.bufferInfo()?.remaining || 0,\n      decodeFps\n    }\n  }\n\n  _bindEvents () {\n    this._core.on(EVENT.DEMUXED_TRACK, ({videoTrack}) => this._stats.updateBitrate(videoTrack.samples))\n\n    this._core.on(EVENT.FLV_SCRIPT_DATA, data => {\n      this._stats.setFpsFromScriptData(data)\n    })\n\n    this._core.on(EVENT.METADATA_PARSED, e => {\n      if (e.type === 'video') {\n        this._stats.setVideoMeta(e.track)\n      } else {\n        this._stats.setAudioMeta(e.track)\n      }\n    })\n\n    this._core.on(EVENT.TTFB, e => {\n      this._stats.setDomain(e.responseUrl)\n    })\n\n  }\n\n  reset () {\n    this._samples = []\n    this._stats = new Stats(this._timescale)\n  }\n\n}\n\nexport { MediaStatsService }\n","import * as mse from './mse'\nimport * as buffer from './buffer'\nimport * as net from './net'\nimport * as error from './error'\nimport * as event from './event'\nimport * as services from './services'\nimport * as streamingHelper from './streaming-helper'\nimport { Logger } from './logger'\n\nexport default {\n  ...mse,\n  ...buffer,\n  ...net,\n  ...error,\n  ...event,\n  ...services,\n  ...streamingHelper,\n  Logger\n}\n"],"names":["createPublicPromise","res","rej","promise","Promise","resolve","reject","used","apply","arguments","nowTime","parseInt","performance","now","e","Date","getTime","Buffer","_classCallCheck","key","value","buf","length","end","start","b","buffered","error","maxHole","buffers","i","l","bufLen","last","lastEnd","push","reduce","a","c","pos","undefined","index","nextStart","nextEnd","prevStart","prevEnd","item","currentTime","behind","remaining","totalLength","ERR","MANIFEST","NETWORK","NETWORK_TIMEOUT","NETWORK_FORBIDDEN","NETWORK_NOTFOUND","NETWROK_RANGE_NOT_SATISFIABLE","DEMUX","REMUX","MEDIA","DRM","OTHER","RUNTIME","SUB_TYPES","FLV","HLS","MP4","FMP4","MSE_ADD_SB","MSE_APPEND_BUFFER","MSE_OTHER","MSE_FULL","OPTION","DASH","LICENSE","CUSTOM_LICENSE","MSE_HIJACK","EME_HIJACK","SIDX","NO_CANPLAY_ERROR","BUFFERBREAK_ERROR","WAITING_TIMEOUT_ERROR","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_CODEC_NOT_SUPPORTED","MEDIA_ERR_URL_EMPTY","ERR_CODE","_defineProperty","_ERR_CODE","StreamingError","_Error","_inherits","_super","_createSuper","type","subType","origin","payload","msg","_this","call","message","errorType","originError","ext","errorCode","errorMessage","Error","_error$response","isTimeout","url","response","httpCode","status","isBrowser","window","LogCacheLevel","DEBUG","LOG","WARN","ERROR","SIMPLE_TYPE","Logger","name","config","this","_prefix","concat","logCacheLevel","logMaxSize","logSize","logTextArray","_createClass","_console","_len","args","Array","_key","logCache","disabled","console","debug","_console2","_len2","_key2","log","_console3","_len3","_key3","warn","_console4","_len4","_key4","text","_len5","logText","_key5","finLogText","map","logable","JSON","stringify","delLog","shift","join","reset","_console5","group","table","groupEnd","val","toLocaleString","reduceDepth","_typeof","objType","Object","prototype","toString","slice","obj","maxDepth","depth","result","includes","hasOwnProperty","getMediaSource","preferMMS","ManagedMediaSource","MediaSource","OP_NAME","MSEError","MSE","media","_this2","create","queue","_queue","op","opName","costtime","_opst","_logger","context","_startQueue","event","_config","assign","getDefaultConfig","bindMedia","openLog","enable","_enqueueBlockingOp2","_unbindMedia","_bindMedia","get","_this$mediaSource","mediaSource","readyState","_url","_this$mediaSource2","duration","_mseFullFlag","VIDEO","_this3","isReduceDuration","bufferEnd","keys","_sourceBuffer","forEach","k","Math","max","_enqueueBlockingOp","isEnded","_this4","_openPromise","isOpened","ms","addEventListener","onOpen","_st","removeEventListener","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this5","wrap","_context","prev","next","unbindMedia","perferMMS","revokeObjectURL","src","URL","createObjectURL","disableRemotePlayback","abrupt","stop","_x","_callee2","hasMetadata","mseOpen","_this6","_context2","t","x","_x$promise","_x$promise$resolve","endOfStream","removeSourceBuffer","removeAttribute","load","mimeType","sb","addSourceBuffer","_onSBUpdateEnd","bind","_onSBUpdateError","_this7","changeType","_enqueueOp","createSource","buffer","_this8","byteLength","_this8$_sourceBuffer$","appendBuffer","startTime","endTime","_this9","isInsertHead","remove","p","_this10","_this11","allClear","_this$_queue$type","initOpque","isinit","reason","_this12","setLiveSeekableRange","exec","_this13","splice","then","_callee3","types","waiters","_this14","_context3","prom","all","updating","_x2","_x3","_x4","indexOf","timestampOffset","_this15","_this16","abort","mime","isTypeSupported","UPDATE_ERROR","LoaderType","FETCH","XHR","ResponseType","ARRAY_BUFFER","TEXT","NetError","request","_assertThisInitialized","isPlainObject","getPrototypeOf","getRangeValue","ret","encode","encodeURIComponent","replace","setUrlParams","params","v","str","isArray","toISOString","isObject","filter","Boolean","hashIndex","createResponse","data","done","contentLength","age","firstByteTime","range","vid","priOptions","parseFloat","Number","isNaN","options","calculateSpeed","byteLen","millisec","round","EVENT","TTFB","LOAD_START","LOAD_RESPONSE_HEADERS","LOAD_COMPLETE","LOAD_RETRY","SOURCEBUFFER_CREATED","ANALYZE_DURATION_EXCEEDED","REMOVE_BUFFER","BUFFEREOS","KEYFRAME","METADATA_PARSED","SEI","SEI_IN_TIME","FLV_SCRIPT_DATA","LOWDECODE","SWITCH_URL_SUCCESS","SWITCH_URL_FAILED","SPEED","HLS_MANIFEST_LOADED","HLS_LEVEL_LOADED","DEMUXED_TRACK","STREAM_EXCEPTION","LARGE_AV_FIRST_FRAME_GAP_DETECT","LARGE_VIDEO_DTS_GAP_DETECT","LARGE_AUDIO_DTS_GAP_DETECT","AUDIO_GAP_DETECT","AUDIO_OVERLAP_DETECT","MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT","REAL_TIME_SPEED","has","prefix","Events","EE","fn","once","addListener","emitter","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","names","events","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","len","removeListener","j","on","removeAllListeners","off","prefixed","module","exports","CACHESIZE","FetchLoader","_EventEmitter","_cancel","_ref","_this$_abortControlle","timeout","responseType","onProgress","onTimeout","onCancel","transformResponse","logger","method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","onProcessMinLen","_aborted","_onProcessMinLen","_onCancel","_abortController","AbortController","_running","_index","_range","_vid","_priOptions","init","signal","clearTimeout","_timeoutTimer","rangeValue","Headers","append","Range","setTimeout","cancel","fetch","_ref2","costTime","speed","_response","ok","sent","json","_loadChunk","arrayBuffer","Uint8Array","time","catch","_error","_reader","t0","st","getReader","err","_cache","_writeIdx","reader","pump","_ref3","_this3$_range","startRange","startByte","curLen","retData","temp","read","_receivedLength","set","XhrLoader","req","_onProgress","_headers","_withCredentials","_body","_method","_timeout","_runing","_responseType","_firstRtt","_onTimeout","_request","_loadCompleteResolve","_loadCompleteReject","_startLoad","chunkSize","_currentChunkSizeKB","from","to","_internalOpen","_startTime","xhr","_xhr","XMLHttpRequest","open","withCredentials","onload","_onLoad","onreadystatechange","_onReadyStatechange","onerror","errorEvent","_errorEvent$currentTa","_errorEvent$currentTa2","_errorEvent$currentTa3","currentTarget","statusText","ontimeout","setRequestHeader","send","target","_this$_range","_objectSpread","byteStart","_this$_range2","chunk","responseURL","_getHeaders","_transformResponse","_getPrototypeOf","_step","_iterator","_createForOfIteratorHelper","getAllResponseHeaders","trim","split","s","n","parts","toLowerCase","f","Task","alive","_loaderType","_loader","_retryCount","_retryTimer","_canceled","_retryCheckFunc","retryCheckFunc","_this$_config","retry","retryDelay","onRetryError","transformError","rest","_objectWithoutProperties","_excluded","isRetry","running","loaderType","retryCount","sleep","paused","ended","playbackRate","video","getVideoPlaybackQuality","info","droppedVideoFrames","corruptedVideoFrames","totalVideoFrames","creationTime","webkitDroppedFrameCount","webkitDecodedFrameCount","arr","prevLen","d","NetLoader","cfg","transformRequest","integrity","getConfig","isSupported","task","loader","_currentTask","_processTask","cancels","_alive","finally","_this3$_currentTask","_this3$_alive","GapService","maxJumpDistance","isLive","seekThreshold","jumpTo","_prevCurrentTime","seeking","SeiService","Set","sei","_seiSet","add","size","min","toThrow","delete","clear","BandwidthService","totalByte","_speeds","_chunkSpeeds","Stats","timescale","_timescale","encodeType","audioCodec","videoCodec","domain","fps","bitrate","width","height","samplerate","channelCount","gop","_data$onMetaData","onMetaData","framerate","track","codec","codecType","fpsNum","fpsDen","sampleRate","responseUrl","samples","sample","_startGopId","gopId","_bitsAccumulateDuration","_bitsAccumulateSize","units","MediaStatsService","core","_core","_stats","_bindEvents","_this$_core","_this$_core2","_this$_core2$speedInf","_this$_core3","_this$_core3$speedInf","_this$_core4","_this$_core4$bufferIn","_ref2$currentTime","_ref2$decodeFps","decodeFps","getStats","downloadSpeed","speedInfo","avgSpeed","bufferInfo","videoTrack","updateBitrate","setFpsFromScriptData","setVideoMeta","setAudioMeta","setDomain","_samples","mse","net","services","streamingHelper"],"mappings":"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"}